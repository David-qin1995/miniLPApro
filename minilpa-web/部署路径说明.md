# ğŸ“‹ éƒ¨ç½²è·¯å¾„è¯´æ˜

## âœ… æœ€ç»ˆéƒ¨ç½²è·¯å¾„

```
/www/wwwroot/minilpa-web
```

## ğŸ“¦ ç›®å½•ç»“æ„

```
/www/wwwroot/minilpa-web/
â”œâ”€â”€ client/                    # å‰ç«¯ä»£ç 
â”‚   â”œâ”€â”€ dist/                 # æ„å»ºè¾“å‡º â† Nginx æŒ‡å‘è¿™é‡Œ
â”‚   â”œâ”€â”€ src/                  # æºä»£ç 
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”œâ”€â”€ server/                   # åç«¯ä»£ç 
â”‚   â”œâ”€â”€ routes/              # API è·¯ç”±
â”‚   â”œâ”€â”€ lpac/                # LPAC é›†æˆ
â”‚   â”œâ”€â”€ db.js                # æ•°æ®åº“
â”‚   â””â”€â”€ index.js             # å…¥å£æ–‡ä»¶ â† PM2 è¿è¡Œè¿™é‡Œ
â”œâ”€â”€ data/                     # æ•°æ®å­˜å‚¨
â”‚   â””â”€â”€ db.json              # æ•°æ®åº“æ–‡ä»¶
â”œâ”€â”€ logs/                     # æ—¥å¿—ç›®å½•
â”‚   â”œâ”€â”€ nginx-access.log     # Nginx è®¿é—®æ—¥å¿—
â”‚   â””â”€â”€ nginx-error.log      # Nginx é”™è¯¯æ—¥å¿—
â”œâ”€â”€ uploads/                  # ä¸Šä¼ æ–‡ä»¶
â”œâ”€â”€ scripts/                  # éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ baota-deploy.sh      # é€šç”¨éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ docs/                     # æ–‡æ¡£
â”œâ”€â”€ .env                      # ç¯å¢ƒå˜é‡
â”œâ”€â”€ package.json              # åç«¯ä¾èµ–
â”œâ”€â”€ ecosystem.config.js       # PM2 é…ç½®
â””â”€â”€ ä¸€é”®éƒ¨ç½²åˆ°esim.haoyiseo.com.sh  # ä¸“å±éƒ¨ç½²è„šæœ¬
```

## ğŸš€ å¦‚ä½•éƒ¨ç½²åˆ°è¿™ä¸ªè·¯å¾„

### æ–¹å¼ä¸€ï¼šä¸€é”®å‘½ä»¤ï¼ˆæ¨èï¼‰â­

```bash
cd /www/wwwroot && \
git clone https://github.com/David-qin1995/miniLPApro.git temp-minilpa && \
mv temp-minilpa/minilpa-web minilpa-web && \
rm -rf temp-minilpa && \
cd minilpa-web && \
bash ä¸€é”®éƒ¨ç½²åˆ°esim.haoyiseo.com.sh
```

### æ–¹å¼äºŒï¼šåˆ†æ­¥æ‰§è¡Œ

```bash
# æ­¥éª¤ 1: å…‹éš†ä»“åº“
cd /www/wwwroot
git clone https://github.com/David-qin1995/miniLPApro.git temp-minilpa

# æ­¥éª¤ 2: æå– minilpa-web ç›®å½•
mv temp-minilpa/minilpa-web minilpa-web
rm -rf temp-minilpa

# æ­¥éª¤ 3: è¿›å…¥é¡¹ç›®ç›®å½•
cd minilpa-web

# æ­¥éª¤ 4: è¿è¡Œéƒ¨ç½²è„šæœ¬
bash ä¸€é”®éƒ¨ç½²åˆ°esim.haoyiseo.com.sh
```

## ğŸŒ Nginx é…ç½®

Nginx é…ç½®æ–‡ä»¶ä¸­çš„è·¯å¾„ï¼š

```nginx
server {
    server_name esim.haoyiseo.com;
    
    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /www/wwwroot/minilpa-web/client/dist;  # â† è¿™é‡Œ
        try_files $uri $uri/ /index.html;
    }
    
    # æ—¥å¿—æ–‡ä»¶
    access_log /www/wwwroot/minilpa-web/logs/nginx-access.log;  # â† è¿™é‡Œ
    error_log /www/wwwroot/minilpa-web/logs/nginx-error.log;    # â† è¿™é‡Œ
}
```

## âš™ï¸ PM2 é…ç½®

PM2 é…ç½®æ–‡ä»¶ `ecosystem.config.js`ï¼š

```javascript
module.exports = {
  apps: [{
    name: 'minilpa',
    script: './server/index.js',  # â† ç›¸å¯¹äº /www/wwwroot/minilpa-web
    cwd: '/www/wwwroot/minilpa-web',  # â† å·¥ä½œç›®å½•
  }]
}
```

## ğŸ” éªŒè¯è·¯å¾„

éƒ¨ç½²å®Œæˆåï¼ŒéªŒè¯è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼š

```bash
# æ£€æŸ¥é¡¹ç›®ç›®å½•
ls -la /www/wwwroot/minilpa-web/

# åº”è¯¥çœ‹åˆ°ï¼š
# client/
# server/
# data/
# logs/
# uploads/
# package.json
# .env
# ç­‰æ–‡ä»¶

# æ£€æŸ¥å‰ç«¯æ„å»ºæ–‡ä»¶
ls -la /www/wwwroot/minilpa-web/client/dist/

# åº”è¯¥çœ‹åˆ°ï¼š
# index.html
# assets/
# ç­‰æ–‡ä»¶

# æ£€æŸ¥ PM2 è¿›ç¨‹
pm2 status

# åº”è¯¥çœ‹åˆ°ï¼š
# minilpa | online | /www/wwwroot/minilpa-web/server/index.js
```

## â“ å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆä¸æ˜¯ `/www/wwwroot/minilpa/minilpa-web`ï¼Ÿ

A: å› ä¸ºä»“åº“ç»“æ„æ˜¯ `miniplapro/minilpa-web/`ï¼Œå¦‚æœç›´æ¥å…‹éš†ä¼šå¯¼è‡´è·¯å¾„å¤šä¸€å±‚ã€‚æˆ‘ä»¬é€šè¿‡å…ˆå…‹éš†åˆ°ä¸´æ—¶ç›®å½•ï¼Œå†æå– `minilpa-web` ç›®å½•çš„æ–¹å¼ï¼Œç¡®ä¿æœ€ç»ˆè·¯å¾„ç®€æ´æ˜äº†ã€‚

### Q: å¯ä»¥ç”¨å…¶ä»–è·¯å¾„å—ï¼Ÿ

A: å¯ä»¥ï¼ä½†éœ€è¦ä¿®æ”¹ä»¥ä¸‹æ–‡ä»¶ï¼š
- `scripts/baota-deploy.sh` ä¸­çš„ `PROJECT_DIR`
- `nginx-esim.haoyiseo.com.conf` ä¸­çš„æ‰€æœ‰è·¯å¾„
- `ecosystem.config.js` ä¸­çš„ `cwd`
- `.env` ä¸­çš„ç›¸å…³è·¯å¾„

### Q: å¦‚ä½•æ›´æ–°ä»£ç ï¼Ÿ

```bash
cd /www/wwwroot/minilpa-web

# æ–¹å¼ä¸€ï¼šGit pullï¼ˆå¦‚æœæ˜¯ Git ä»“åº“ï¼‰
git pull

# æ–¹å¼äºŒï¼šé‡æ–°ä¸‹è½½
cd /www/wwwroot
rm -rf minilpa-web
git clone https://github.com/David-qin1995/miniLPApro.git temp-minilpa
mv temp-minilpa/minilpa-web minilpa-web
rm -rf temp-minilpa

# é‡æ–°éƒ¨ç½²
cd minilpa-web
npm install
cd client && npm install && cd ..
npm run build
pm2 restart minilpa
```

## âœ… æ€»ç»“

- **éƒ¨ç½²è·¯å¾„**: `/www/wwwroot/minilpa-web`
- **å‰ç«¯æ„å»º**: `/www/wwwroot/minilpa-web/client/dist`
- **åç«¯å…¥å£**: `/www/wwwroot/minilpa-web/server/index.js`
- **æ•°æ®åº“**: `/www/wwwroot/minilpa-web/data/db.json`
- **æ—¥å¿—ç›®å½•**: `/www/wwwroot/minilpa-web/logs/`
- **ä¸Šä¼ ç›®å½•**: `/www/wwwroot/minilpa-web/uploads/`

æ‰€æœ‰é…ç½®æ–‡ä»¶å’Œè„šæœ¬éƒ½å·²æŒ‰æ­¤è·¯å¾„é…ç½®å¥½ï¼Œç›´æ¥ä½¿ç”¨å³å¯ï¼ ğŸ‰
