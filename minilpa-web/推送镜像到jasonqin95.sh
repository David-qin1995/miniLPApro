#!/bin/bash

# ========================================
# æ¨é€é•œåƒåˆ° jasonqin95 ä»“åº“
# ========================================

set -e

echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                                                               â•‘"
echo "â•‘  ğŸ³ æ¨é€é•œåƒåˆ° jasonqin95/minilpa-web                         â•‘"
echo "â•‘                                                               â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""

# 1. Tag é•œåƒ
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "[1/4] ç»™é•œåƒæ‰“ Tag..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

docker tag davidqin1995/minilpa-web:latest jasonqin95/minilpa-web:latest
docker tag davidqin1995/minilpa-web:v1.0.0 jasonqin95/minilpa-web:v1.0.0

if [ $? -eq 0 ]; then
    echo "âœ… Tag å®Œæˆ"
    echo ""
    docker images | grep "jasonqin95/minilpa-web"
else
    echo "âŒ Tag å¤±è´¥"
    exit 1
fi

echo ""

# 2. ç™»å½• Docker Hub
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "[2/4] ç™»å½• Docker Hub..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

docker login

if [ $? -eq 0 ]; then
    echo "âœ… ç™»å½•æˆåŠŸ"
else
    echo "âŒ ç™»å½•å¤±è´¥"
    exit 1
fi

echo ""

# 3. æ¨é€é•œåƒ
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "[3/4] æ¨é€é•œåƒåˆ° Docker Hub..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

docker push jasonqin95/minilpa-web:latest
docker push jasonqin95/minilpa-web:v1.0.0

if [ $? -eq 0 ]; then
    echo "âœ… æ¨é€æˆåŠŸ"
else
    echo "âŒ æ¨é€å¤±è´¥"
    exit 1
fi

echo ""

# 4. éªŒè¯æ¨é€
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo "[4/4] éªŒè¯æ¨é€..."
echo "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"
echo ""

bash check-image.sh jasonqin95/minilpa-web latest

echo ""
echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
echo "â•‘                                                               â•‘"
echo "â•‘  âœ… é•œåƒæ¨é€å®Œæˆï¼                                           â•‘"
echo "â•‘                                                               â•‘"
echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸŒ é•œåƒåœ°å€:"
echo "  â€¢ jasonqin95/minilpa-web:latest"
echo "  â€¢ jasonqin95/minilpa-web:v1.0.0"
echo ""
echo "ğŸ“¦ åœ¨æœåŠ¡å™¨ä¸Šæ‹‰å–:"
echo "  docker pull jasonqin95/minilpa-web:latest"
echo "  æˆ–ä½¿ç”¨éƒ¨ç½²è„šæœ¬: bash docker-pull-deploy.sh"
echo ""

