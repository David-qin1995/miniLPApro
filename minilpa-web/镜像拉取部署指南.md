# ğŸ³ é•œåƒæ‹‰å–éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•

- [æ–¹æ¡ˆæ¦‚è¿°](#æ–¹æ¡ˆæ¦‚è¿°)
- [ä¼˜åŠ¿è¯´æ˜](#ä¼˜åŠ¿è¯´æ˜)
- [å®Œæ•´æµç¨‹](#å®Œæ•´æµç¨‹)
- [æœ¬åœ°æ„å»ºå’Œæ¨é€](#æœ¬åœ°æ„å»ºå’Œæ¨é€)
- [æœåŠ¡å™¨æ‹‰å–å’Œéƒ¨ç½²](#æœåŠ¡å™¨æ‹‰å–å’Œéƒ¨ç½²)
- [é•œåƒä»“åº“é…ç½®](#é•œåƒä»“åº“é…ç½®)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [ç»´æŠ¤å’Œæ›´æ–°](#ç»´æŠ¤å’Œæ›´æ–°)

---

## ğŸ¯ æ–¹æ¡ˆæ¦‚è¿°

**é•œåƒæ‹‰å–éƒ¨ç½²**æ˜¯æŒ‡ï¼š
1. **æœ¬åœ°æ„å»º** Docker é•œåƒ
2. **æ¨é€åˆ°** Docker Hub æˆ–å›½å†…é•œåƒä»“åº“
3. **æœåŠ¡å™¨æ‹‰å–**é•œåƒå¹¶è¿è¡Œå®¹å™¨

è¿™ç§æ–¹å¼å®Œç¾è§£å†³äº†æœåŠ¡å™¨æ„å»ºæ—¶çš„èµ„æºæ¶ˆè€—å’Œç½‘ç»œé—®é¢˜ã€‚

---

## âœ… ä¼˜åŠ¿è¯´æ˜

### vs æœåŠ¡å™¨æ„å»ºæ–¹å¼

| ç‰¹æ€§ | é•œåƒæ‹‰å–éƒ¨ç½² | æœåŠ¡å™¨æ„å»º |
|------|------------|-----------|
| **æ„å»ºç¯å¢ƒ** | âœ… æœ¬åœ°ï¼ˆèµ„æºå……è¶³ï¼‰ | âŒ æœåŠ¡å™¨ï¼ˆèµ„æºæœ‰é™ï¼‰ |
| **æ„å»ºé€Ÿåº¦** | âœ… å¿«ï¼ˆ3-5åˆ†é’Ÿï¼‰ | âŒ æ…¢ï¼ˆ10-30åˆ†é’Ÿï¼‰ |
| **æœåŠ¡å™¨èµ„æº** | âœ… ä½ï¼ˆåªè¿è¡Œï¼‰ | âŒ é«˜ï¼ˆæ„å»º+è¿è¡Œï¼‰ |
| **ç½‘ç»œé—®é¢˜** | âœ… æ— ï¼ˆæœ¬åœ°ç½‘ç»œå¥½ï¼‰ | âŒ å®¹æ˜“å¡ä½ |
| **éƒ¨ç½²é€Ÿåº¦** | âœ… å¿«ï¼ˆæ‹‰å–å³ç”¨ï¼‰ | âŒ æ…¢ï¼ˆéœ€è¦æ„å»ºï¼‰ |
| **ç‰ˆæœ¬ç®¡ç†** | âœ… æ¸…æ™°ï¼ˆtagç®¡ç†ï¼‰ | âŒ éš¾ä»¥ç®¡ç† |
| **å›æ»šé€Ÿåº¦** | âœ… ç§’çº§ | âŒ éœ€è¦é‡å»º |
| **é¢„æµ‹è¯•** | âœ… å¯ä»¥æµ‹è¯• | âŒ æ— æ³•é¢„æµ‹è¯• |

---

## ğŸ”„ å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœ¬åœ°å¼€å‘ç¯å¢ƒ   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 1. æ„å»ºé•œåƒ
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Docker é•œåƒ    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 2. æ¨é€é•œåƒ
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  é•œåƒä»“åº“       â”‚
â”‚ (Docker Hub/    â”‚
â”‚  é˜¿é‡Œäº‘/è…¾è®¯äº‘) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ 3. æœåŠ¡å™¨æ‹‰å–
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æœåŠ¡å™¨è¿è¡Œ     â”‚
â”‚  (Docker å®¹å™¨)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ—ï¸ æœ¬åœ°æ„å»ºå’Œæ¨é€

### å‰ç½®è¦æ±‚

- âœ… Docker Desktopï¼ˆæœ¬åœ°å·²å®‰è£…ï¼‰
- âœ… Docker Hub è´¦å·ï¼ˆæˆ–é˜¿é‡Œäº‘/è…¾è®¯äº‘è´¦å·ï¼‰
- âœ… é¡¹ç›®ä»£ç å·²å…‹éš†åˆ°æœ¬åœ°

### æ­¥éª¤ 1: ç™»å½•é•œåƒä»“åº“

#### Docker Hub

```bash
docker login
# è¾“å…¥ç”¨æˆ·å: davidqin1995
# è¾“å…¥å¯†ç : [æ‚¨çš„å¯†ç ]
```

#### é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡

```bash
docker login --username=your-username registry.cn-hangzhou.aliyuncs.com
# è¾“å…¥å¯†ç : [æ‚¨çš„å¯†ç ]
```

### æ­¥éª¤ 2: æ„å»ºå¹¶æ¨é€é•œåƒ

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰â­â­â­â­â­

```bash
cd /Users/jason/devTools/code/miniplapro/minilpa-web

# æ„å»ºå¹¶æ¨é€ï¼ˆé»˜è®¤ latest æ ‡ç­¾ï¼‰
bash build-and-push.sh

# æˆ–æŒ‡å®šç‰ˆæœ¬å·
bash build-and-push.sh v1.0.0
```

**è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆ**ï¼š
- âœ… æ„å»º Docker é•œåƒ
- âœ… æµ‹è¯•é•œåƒï¼ˆå¯é€‰ï¼‰
- âœ… æ¨é€åˆ°ä»“åº“ï¼ˆlatest å’Œç‰ˆæœ¬æ ‡ç­¾ï¼‰

#### æ–¹å¼äºŒï¼šæ‰‹åŠ¨æ„å»º

```bash
# 1. æ„å»ºé•œåƒ
docker build -t davidqin1995/minilpa-web:v1.0.0 .
docker tag davidqin1995/minilpa-web:v1.0.0 davidqin1995/minilpa-web:latest

# 2. æµ‹è¯•é•œåƒï¼ˆå¯é€‰ï¼‰
docker run -d -p 3001:3000 --name minilpa-test davidqin1995/minilpa-web:v1.0.0
curl http://localhost:3001/api/health
docker stop minilpa-test && docker rm minilpa-test

# 3. æ¨é€é•œåƒ
docker push davidqin1995/minilpa-web:v1.0.0
docker push davidqin1995/minilpa-web:latest
```

### æ­¥éª¤ 3: éªŒè¯æ¨é€

```bash
# æŸ¥çœ‹æœ¬åœ°é•œåƒ
docker images | grep minilpa-web

# æˆ–åœ¨æµè§ˆå™¨è®¿é—®
# https://hub.docker.com/r/davidqin1995/minilpa-web/tags
```

---

## ğŸš€ æœåŠ¡å™¨æ‹‰å–å’Œéƒ¨ç½²

### å‰ç½®è¦æ±‚

- âœ… CentOS 7/8ã€Ubuntu 18.04+ ç­‰ Linux ç³»ç»Ÿ
- âœ… Docker 20.10+ å·²å®‰è£…
- âœ… docker-compose 1.29+ å·²å®‰è£…ï¼ˆæˆ–ä½¿ç”¨ `docker compose`ï¼‰

### æ­¥éª¤ 1: å®‰è£… Dockerï¼ˆå¦‚æœæœªå®‰è£…ï¼‰

```bash
# å¿«é€Ÿå®‰è£… Docker
curl -fsSL https://get.docker.com | bash -

# å¯åŠ¨ Docker
systemctl start docker
systemctl enable docker

# éªŒè¯å®‰è£…
docker --version
docker-compose --version
```

### æ­¥éª¤ 2: è·å–é¡¹ç›®ä»£ç 

```bash
# æ–¹å¼ä¸€ï¼šGit å…‹éš†ï¼ˆæ¨èï¼‰
cd /www/wwwroot
git clone https://github.com/David-qin1995/miniLPApro.git temp-minilpa
mv temp-minilpa/minilpa-web minilpa-web
rm -rf temp-minilpa

# æ–¹å¼äºŒï¼šç›´æ¥ä¸‹è½½ï¼ˆå¦‚æœæ²¡æœ‰ Gitï¼‰
cd /www/wwwroot
wget https://github.com/David-qin1995/miniLPApro/archive/main.zip
unzip main.zip
mv miniLPApro-main/minilpa-web minilpa-web
```

### æ­¥éª¤ 3: è¿›å…¥é¡¹ç›®ç›®å½•

```bash
cd /www/wwwroot/minilpa-web
```

### æ­¥éª¤ 4: é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp env.esim.haoyiseo.com .env

# ç¼–è¾‘é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼‰
vim .env
```

**é‡è¦é…ç½®é¡¹**ï¼š
```bash
# åŸŸåï¼ˆå¿…é¡»ä¿®æ”¹ï¼‰
CORS_ORIGIN=https://esim.haoyiseo.com

# Session å¯†é’¥ï¼ˆå»ºè®®ä¿®æ”¹ä¸ºéšæœºå­—ç¬¦ä¸²ï¼‰
SESSION_SECRET=your-random-secret-here

# æ˜¯å¦ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
USE_MOCK_DATA=true  # true=æ¨¡æ‹Ÿï¼Œfalse=çœŸå®ç¡¬ä»¶
```

### æ­¥éª¤ 5: ä¸€é”®éƒ¨ç½²ï¼ˆæ¨èï¼‰â­â­â­â­â­

```bash
# ä½¿ç”¨éƒ¨ç½²è„šæœ¬ï¼ˆè‡ªåŠ¨æ‹‰å–å¹¶è¿è¡Œï¼‰
bash docker-pull-deploy.sh

# æˆ–æŒ‡å®šç‰ˆæœ¬
bash docker-pull-deploy.sh v1.0.0
```

**è„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆ**ï¼š
- âœ… æ£€æŸ¥ Docker ç¯å¢ƒ
- âœ… åˆ›å»ºæ•°æ®ç›®å½•
- âœ… æ‹‰å–æœ€æ–°é•œåƒ
- âœ… åœæ­¢æ—§å®¹å™¨
- âœ… å¯åŠ¨æ–°å®¹å™¨
- âœ… å¥åº·æ£€æŸ¥
- âœ… çŠ¶æ€éªŒè¯

### æ­¥éª¤ 6: æ‰‹åŠ¨éƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

```bash
# 1. æ‹‰å–é•œåƒ
docker pull davidqin1995/minilpa-web:latest

# 2. åˆ›å»ºå¿…è¦ç›®å½•
mkdir -p data logs uploads logs/nginx

# 3. å¯åŠ¨å®¹å™¨
docker-compose -f docker-compose.image.yml up -d

# 4. æŸ¥çœ‹çŠ¶æ€
docker-compose -f docker-compose.image.yml ps

# 5. æŸ¥çœ‹æ—¥å¿—
docker-compose -f docker-compose.image.yml logs -f
```

---

## ğŸª é•œåƒä»“åº“é…ç½®

### Docker Hubï¼ˆæ¨èï¼‰â­â­â­â­â­

**ä¼˜ç‚¹**ï¼š
- âœ… å…¨çƒ CDNï¼Œè®¿é—®é€Ÿåº¦å¿«
- âœ… å…è´¹ä½¿ç”¨ï¼ˆå…¬å¼€ä»“åº“ï¼‰
- âœ… ä½¿ç”¨ç®€å•

**é…ç½®**ï¼š

1. æ³¨å†Œè´¦å·ï¼šhttps://hub.docker.com/
2. åˆ›å»ºä»“åº“ï¼š
   - è®¿é—®ï¼šhttps://hub.docker.com/repositories
   - ç‚¹å‡» "Create Repository"
   - åç§°ï¼š`minilpa-web`
   - å¯è§æ€§ï¼šPublicï¼ˆå…è´¹ï¼‰
3. ä¿®æ”¹ `build-and-push.sh`ï¼š
   ```bash
   IMAGE_NAME="davidqin1995/minilpa-web"
   ```
4. ä¿®æ”¹ `docker-compose.image.yml`ï¼š
   ```yaml
   image: davidqin1995/minilpa-web:latest
   ```

---

### é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ï¼ˆå›½å†…æ¨èï¼‰â­â­â­â­â­

**ä¼˜ç‚¹**ï¼š
- âœ… å›½å†…è®¿é—®é€Ÿåº¦å¿«
- âœ… å…è´¹ä½¿ç”¨ï¼ˆæœ‰é¢åº¦ï¼‰
- âœ… æ”¯æŒç§æœ‰ä»“åº“

**é…ç½®**ï¼š

1. æ³¨å†Œå¹¶ç™»å½•ï¼šhttps://cr.console.aliyun.com/
2. åˆ›å»ºå‘½åç©ºé—´ï¼š
   - è®¿é—®ï¼šå®¹å™¨é•œåƒæœåŠ¡ â†’ å‘½åç©ºé—´
   - ç‚¹å‡» "åˆ›å»ºå‘½åç©ºé—´"
   - åç§°ï¼š`minilpa`ï¼ˆæˆ–æ‚¨çš„å‘½åï¼‰
3. åˆ›å»ºé•œåƒä»“åº“ï¼š
   - è®¿é—®ï¼šå®¹å™¨é•œåƒæœåŠ¡ â†’ é•œåƒä»“åº“
   - ç‚¹å‡» "åˆ›å»ºé•œåƒä»“åº“"
   - å‘½åç©ºé—´ï¼šé€‰æ‹©åˆšåˆ›å»ºçš„
   - ä»“åº“åç§°ï¼š`minilpa-web`
   - ä»“åº“ç±»å‹ï¼šå…¬å¼€ æˆ– ç§æœ‰
4. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼š

   **build-and-push.sh**ï¼š
   ```bash
   IMAGE_NAME="registry.cn-hangzhou.aliyuncs.com/minilpa/minilpa-web"
   ```

   **docker-compose.image.yml**ï¼š
   ```yaml
   image: registry.cn-hangzhou.aliyuncs.com/minilpa/minilpa-web:latest
   ```

5. ç™»å½•ï¼š
   ```bash
   docker login --username=your-username registry.cn-hangzhou.aliyuncs.com
   ```

---

### è…¾è®¯äº‘å®¹å™¨é•œåƒæœåŠ¡

**é…ç½®**ï¼š

```bash
IMAGE_NAME="ccr.ccs.tencentyun.com/your-namespace/minilpa-web"
```

---

## ğŸ“ è¯¦ç»†éƒ¨ç½²æ­¥éª¤

### æœ¬åœ°ç¯å¢ƒï¼šæ„å»ºå’Œæ¨é€

#### æ­¥éª¤ 1: å‡†å¤‡é¡¹ç›®

```bash
cd /Users/jason/devTools/code/miniplapro/minilpa-web

# ç¡®ä¿ä»£ç æ˜¯æœ€æ–°çš„
git pull origin main
```

#### æ­¥éª¤ 2: é…ç½®é•œåƒåç§°

ç¼–è¾‘ `build-and-push.sh`ï¼š

```bash
# Docker Hub
IMAGE_NAME="davidqin1995/minilpa-web"

# æˆ–é˜¿é‡Œäº‘
IMAGE_NAME="registry.cn-hangzhou.aliyuncs.com/minilpa/minilpa-web"
```

#### æ­¥éª¤ 3: æ„å»ºå¹¶æ¨é€

```bash
# ç™»å½•ï¼ˆå¦‚æœæœªç™»å½•ï¼‰
docker login

# æ„å»ºå¹¶æ¨é€
bash build-and-push.sh v1.0.0
```

**é¢„æœŸè¾“å‡º**ï¼š
```
[1/4] æ„å»º Docker é•œåƒ...
âœ… é•œåƒæ„å»ºæˆåŠŸ

[2/4] æµ‹è¯•é•œåƒ...
âœ… é•œåƒæµ‹è¯•é€šè¿‡

[3/4] ç™»å½• Docker Hub...
âœ… ç™»å½•æˆåŠŸ

[4/4] æ¨é€é•œåƒåˆ°ä»“åº“...
âœ… æ¨é€æˆåŠŸï¼
```

---

### æœåŠ¡å™¨ç¯å¢ƒï¼šæ‹‰å–å’Œéƒ¨ç½²

#### æ­¥éª¤ 1: å‡†å¤‡ç¯å¢ƒ

```bash
# SSH ç™»å½•æœåŠ¡å™¨
ssh root@your-server-ip

# å®‰è£… Dockerï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
curl -fsSL https://get.docker.com | bash -
systemctl start docker
systemctl enable docker
```

#### æ­¥éª¤ 2: è·å–é¡¹ç›®

```bash
cd /www/wwwroot

# å…‹éš†é¡¹ç›®
git clone https://github.com/David-qin1995/miniLPApro.git temp-minilpa
mv temp-minilpa/minilpa-web minilpa-web
rm -rf temp-minilpa

cd minilpa-web
```

#### æ­¥éª¤ 3: é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶æ¨¡æ¿
cp env.esim.haoyiseo.com .env

# æ£€æŸ¥é…ç½®
cat .env | grep -E "CORS_ORIGIN|SESSION_SECRET"
```

#### æ­¥éª¤ 4: ä¿®æ”¹é•œåƒé…ç½®

ç¼–è¾‘ `docker-compose.image.yml`ï¼Œç¡®ä¿é•œåƒåç§°æ­£ç¡®ï¼š

```yaml
services:
  minilpa-web:
    image: davidqin1995/minilpa-web:latest  # ä¿®æ”¹ä¸ºæ‚¨çš„é•œåƒå
```

#### æ­¥éª¤ 5: ä¸€é”®éƒ¨ç½²

```bash
bash docker-pull-deploy.sh
```

**é¢„æœŸè¾“å‡º**ï¼š
```
[1/5] åˆ›å»ºæ•°æ®ç›®å½•...
âœ… ç›®å½•åˆ›å»ºå®Œæˆ

[2/5] æ›´æ–°é•œåƒé…ç½®...
âœ… é…ç½®æ›´æ–°å®Œæˆ

[3/5] æ‹‰å– Docker é•œåƒ...
âœ… é•œåƒæ‹‰å–æˆåŠŸ

[4/5] åœæ­¢æ—§å®¹å™¨...
âœ… æ—§å®¹å™¨å·²åœæ­¢

[5/5] å¯åŠ¨å®¹å™¨...
âœ… å®¹å™¨å¯åŠ¨æˆåŠŸ

âœ… åç«¯æœåŠ¡æ­£å¸¸
âœ… Nginx ä»£ç†æ­£å¸¸
```

#### æ­¥éª¤ 6: éªŒè¯éƒ¨ç½²

```bash
# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker-compose -f docker-compose.image.yml ps

# åº”è¯¥çœ‹åˆ°ï¼š
# NAME           STATUS    PORTS
# minilpa-web    Up        0.0.0.0:3000->3000/tcp
# minilpa-nginx  Up        0.0.0.0:80->80/tcp

# æµ‹è¯•åç«¯
curl http://localhost:3000/api/health

# æµ‹è¯• Nginx
curl http://localhost/api/health
```

---

## âš™ï¸ é…ç½®è¯´æ˜

### docker-compose.image.yml

```yaml
services:
  minilpa-web:
    image: davidqin1995/minilpa-web:latest  # é•œåƒåç§°
    ports:
      - "3000:3000"  # åç«¯ç«¯å£
    environment:
      - CORS_ORIGIN=https://esim.haoyiseo.com
    volumes:
      - ./data:/app/data        # æ•°æ®æŒä¹…åŒ–
      - ./logs:/app/logs        # æ—¥å¿—æŒä¹…åŒ–
      - ./uploads:/app/uploads  # ä¸Šä¼ æ–‡ä»¶æŒä¹…åŒ–
      - ./.env:/app/.env:ro     # ç¯å¢ƒå˜é‡

  nginx:
    image: nginx:alpine  # å®˜æ–¹ Nginx é•œåƒ
    ports:
      - "80:80"
      - "443:443"
    depends_on:
      - minilpa-web
```

### é•œåƒæ ‡ç­¾è¯´æ˜

- `latest` - æœ€æ–°ç‰ˆæœ¬ï¼ˆæ¨èç”¨äºç”Ÿäº§ï¼‰
- `v1.0.0` - å…·ä½“ç‰ˆæœ¬å·ï¼ˆç”¨äºç‰ˆæœ¬ç®¡ç†ï¼‰
- `v1.0.0-beta` - æµ‹è¯•ç‰ˆæœ¬

---

## ğŸ”§ å¸¸è§é—®é¢˜

### é—®é¢˜ 1: é•œåƒæ‹‰å–å¤±è´¥

**é”™è¯¯**ï¼š`Error pulling image: repository not found`

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥é•œåƒåç§°æ˜¯å¦æ­£ç¡®
cat docker-compose.image.yml | grep image

# 2. æ£€æŸ¥é•œåƒæ˜¯å¦å·²æ¨é€
# è®¿é—® https://hub.docker.com/r/davidqin1995/minilpa-web

# 3. å¦‚æœä½¿ç”¨ç§æœ‰ä»“åº“ï¼Œå…ˆç™»å½•
docker login
```

---

### é—®é¢˜ 2: å®¹å™¨æ— æ³•å¯åŠ¨

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
docker-compose -f docker-compose.image.yml logs minilpa-web

# æ£€æŸ¥é…ç½®
docker-compose -f docker-compose.image.yml config

# æ£€æŸ¥ç«¯å£å ç”¨
lsof -i:3000
```

---

### é—®é¢˜ 3: ç¯å¢ƒå˜é‡ä¸ç”Ÿæ•ˆ

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# 1. æ£€æŸ¥ .env æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la .env

# 2. æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®
cat .env | grep CORS_ORIGIN

# 3. é‡å¯å®¹å™¨
docker-compose -f docker-compose.image.yml restart minilpa-web
```

---

### é—®é¢˜ 4: æ•°æ®ä¸¢å¤±

**åŸå› **ï¼šæ•°æ®å·æ˜ å°„ä¸æ­£ç¡®

**è§£å†³æ–¹æ¡ˆ**ï¼š
```yaml
# ç¡®ä¿ docker-compose.image.yml ä¸­æœ‰æ•°æ®å·æ˜ å°„
volumes:
  - ./data:/app/data        # æ•°æ®ç›®å½•
  - ./logs:/app/logs        # æ—¥å¿—ç›®å½•
  - ./uploads:/app/uploads  # ä¸Šä¼ ç›®å½•
```

---

## ğŸ”„ ç»´æŠ¤å’Œæ›´æ–°

### æ›´æ–°åº”ç”¨

```bash
# 1. æœ¬åœ°æ„å»ºæ–°ç‰ˆæœ¬
cd /Users/jason/devTools/code/miniplapro/minilpa-web
bash build-and-push.sh v1.0.1

# 2. æœåŠ¡å™¨æ‹‰å–æ–°ç‰ˆæœ¬
ssh root@your-server-ip
cd /www/wwwroot/minilpa-web
bash docker-pull-deploy.sh v1.0.1
```

### å›æ»šåˆ°æ—§ç‰ˆæœ¬

```bash
cd /www/wwwroot/minilpa-web

# ç›´æ¥æŒ‡å®šæ—§ç‰ˆæœ¬å·
bash docker-pull-deploy.sh v1.0.0
```

### æŸ¥çœ‹å½“å‰ç‰ˆæœ¬

```bash
# æŸ¥çœ‹é•œåƒæ ‡ç­¾
docker images | grep minilpa-web

# æŸ¥çœ‹å®¹å™¨ä½¿ç”¨çš„é•œåƒ
docker-compose -f docker-compose.image.yml ps
docker inspect minilpa-web | grep Image
```

### æ¸…ç†æ—§é•œåƒ

```bash
# åˆ é™¤æœªä½¿ç”¨çš„é•œåƒ
docker image prune -a

# åˆ é™¤ç‰¹å®šé•œåƒçš„æ—§ç‰ˆæœ¬
docker rmi davidqin1995/minilpa-web:v0.9.0
```

---

## ğŸ“Š éƒ¨ç½²æ£€æŸ¥æ¸…å•

### æœ¬åœ°æ„å»ºé˜¶æ®µ

- [ ] Docker Desktop å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] å·²ç™»å½•é•œåƒä»“åº“ï¼ˆ`docker login`ï¼‰
- [ ] é•œåƒåç§°å·²é…ç½®æ­£ç¡®
- [ ] é•œåƒæ„å»ºæˆåŠŸ
- [ ] é•œåƒæµ‹è¯•é€šè¿‡
- [ ] é•œåƒå·²æ¨é€åˆ°ä»“åº“

### æœåŠ¡å™¨éƒ¨ç½²é˜¶æ®µ

- [ ] Docker å·²å®‰è£…ï¼ˆ`docker --version`ï¼‰
- [ ] docker-compose å·²å®‰è£…
- [ ] é¡¹ç›®ä»£ç å·²è·å–
- [ ] `.env` æ–‡ä»¶å·²é…ç½®
- [ ] `CORS_ORIGIN` å·²ä¿®æ”¹ä¸ºæ­£ç¡®åŸŸå
- [ ] `SESSION_SECRET` å·²ä¿®æ”¹ä¸ºéšæœºå­—ç¬¦ä¸²
- [ ] é•œåƒåç§°å·²é…ç½®æ­£ç¡®
- [ ] é•œåƒæ‹‰å–æˆåŠŸ
- [ ] å®¹å™¨å¯åŠ¨æˆåŠŸ
- [ ] åç«¯å¥åº·æ£€æŸ¥é€šè¿‡
- [ ] Nginx ä»£ç†æ­£å¸¸
- [ ] åŸŸåå·²è§£æ
- [ ] SSL è¯ä¹¦å·²é…ç½®ï¼ˆå¯é€‰ï¼‰

---

## ğŸ¯ å¿«é€Ÿå‚è€ƒ

### æœ¬åœ°æ„å»ºå’Œæ¨é€ï¼ˆä¸€æ¡å‘½ä»¤ï¼‰

```bash
cd /Users/jason/devTools/code/miniplapro/minilpa-web && \
docker login && \
bash build-and-push.sh
```

### æœåŠ¡å™¨éƒ¨ç½²ï¼ˆä¸€æ¡å‘½ä»¤ï¼‰

```bash
cd /www/wwwroot/minilpa-web && \
cp env.esim.haoyiseo.com .env && \
bash docker-pull-deploy.sh
```

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

### æ—¶é—´å¯¹æ¯”

| é˜¶æ®µ | é•œåƒæ‹‰å–éƒ¨ç½² | æœåŠ¡å™¨æ„å»º |
|------|------------|-----------|
| **æœ¬åœ°æ„å»º** | 3-5 åˆ†é’Ÿ | - |
| **æ¨é€é•œåƒ** | 1-2 åˆ†é’Ÿ | - |
| **æœåŠ¡å™¨æ‹‰å–** | 30 ç§’ - 2 åˆ†é’Ÿ | - |
| **æœåŠ¡å™¨æ„å»º** | - | 10-30 åˆ†é’Ÿ |
| **æ€»è®¡** | **5-9 åˆ†é’Ÿ** | **10-30 åˆ†é’Ÿ** |

### èµ„æºå¯¹æ¯”

| èµ„æº | é•œåƒæ‹‰å–éƒ¨ç½² | æœåŠ¡å™¨æ„å»º |
|------|------------|-----------|
| **æœåŠ¡å™¨ CPU** | 10% (è¿è¡Œ) | 100% (æ„å»º) |
| **æœåŠ¡å™¨å†…å­˜** | 512MB | 2GB+ |
| **æœåŠ¡å™¨å¸¦å®½** | 100MB (æ‹‰å–) | 500MB+ (npmåŒ…) |

---

## âœ… ä¼˜åŠ¿æ€»ç»“

1. âœ… **é€Ÿåº¦å¿«** - æœåŠ¡å™¨åªæ‹‰å–ï¼Œä¸æ„å»º
2. âœ… **èµ„æºçœ** - ä¸å ç”¨æœåŠ¡å™¨æ„å»ºèµ„æº
3. âœ… **ç½‘ç»œå¥½** - æœ¬åœ°ç½‘ç»œé€šå¸¸æ›´ç¨³å®š
4. âœ… **æ˜“ç®¡ç†** - ç‰ˆæœ¬æ¸…æ™°ï¼Œå›æ»šç®€å•
5. âœ… **å¯æµ‹è¯•** - æœ¬åœ°å¯ä»¥é¢„æµ‹è¯•é•œåƒ
6. âœ… **å¯é æ€§é«˜** - é¿å…æœåŠ¡å™¨ç¯å¢ƒé—®é¢˜

---

## ğŸ‰ æ€»ç»“

**é•œåƒæ‹‰å–éƒ¨ç½²æ–¹å¼æ˜¯æœ€æ¨èçš„éƒ¨ç½²æ–¹æ¡ˆï¼**

- ğŸš€ **éƒ¨ç½²é€Ÿåº¦å¿«**
- ğŸ’° **èµ„æºæ¶ˆè€—ä½**
- ğŸ”’ **å¯é æ€§é«˜**
- ğŸ“¦ **ç‰ˆæœ¬ç®¡ç†æ¸…æ™°**

**æ¨èä½¿ç”¨ï¼** ğŸ³âœ¨

---

## ğŸ“ è·å–å¸®åŠ©

- ğŸ“– è¯¦ç»†æ–‡æ¡£: `é•œåƒéƒ¨ç½²æ–¹æ¡ˆ.md`
- ğŸ³ Docker æŒ‡å—: `Dockeréƒ¨ç½²æŒ‡å—.md`
- ğŸ”§ æ•…éšœæ’æŸ¥: æŸ¥çœ‹æœ¬æ–‡"å¸¸è§é—®é¢˜"éƒ¨åˆ†

